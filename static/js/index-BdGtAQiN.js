var C=(S,n,_)=>new Promise((w,D)=>{var g=r=>{try{c(_.next(r))}catch(k){D(k)}},b=r=>{try{c(_.throw(r))}catch(k){D(k)}},c=r=>r.done?w(r.value):Promise.resolve(r.value).then(g,b);c((_=_.apply(S,n)).next())});import{_ as q}from"./MainButton.vue_vue_type_script_setup_true_lang-B7_wmTtQ.js";import{_ as z}from"./index-CyUaUaxn.js";import{_ as A}from"./customHeader-B56jzoOn.js";import{_ as G}from"./like-CCpO5s7p.js";import{A as m,M as N,D as L,p as d}from"./big-Bs49lsdF.js";import{g as M,f as U}from"./index-BW6EuzMu.js";import{u as H,a as P}from"./stock-X0YulnmI.js";import{a as W,A as X,z as J,r as y,n as Z,N as x,a8 as ss,a9 as F,a6 as ts,p as v,o as h,e as $,B as s,w as O,E as e,u as i,D as I,a7 as es,M as V,O as Q,af as os,F as as,X as is}from"./vendor-DixqdoKt.js";import{_ as ns}from"./index-BXVDO5jB.js";import"./index-BeltsHFN.js";import"./loading-8XKiFQcW.js";const ls={class:"market-overview"},ds={class:"header"},cs={class:"head_left"},rs={class:"stockName"},us={class:"chg"},_s={class:"close"},vs={class:"head_right"},hs={class:"price-section"},ps={class:"price-info"},ms={class:"current-price"},gs={class:"price-change"},bs={class:"exchange-info"},ks={class:"exchange-label"},fs={class:"content-section"},ys={class:"market-depth"},ws={class:"depth-header"},Ds={class:"depth-title"},Bs={class:"loading_Content"},Cs={class:"depth-table"},$s={class:"bid-section"},Ss={class:"table-header"},Ns={class:"text-center"},Ls={class:"text-right"},Ms={class:"text-right"},Fs={class:"ask-section"},Os={class:"table-header"},Is={class:"text-center"},Vs={class:"text-right"},Qs={class:"text-right"},Ts={class:"ratio-section"},Es={class:"ratio-numbers"},Ks={class:"ratio-bar"},Rs={class:"ratio-labels"},Ys={class:"basic-data"},js={class:"data-row"},qs={class:"data-item"},zs={class:"data-label"},As={class:"data-value"},Gs={class:"data-item"},Us={class:"data-label"},Hs={class:"data-value"},Ps={class:"data-item"},Ws={class:"data-label"},Xs={class:"data-value"},Js={class:"data-item"},Zs={class:"data-label"},xs={class:"data-value"},st={class:"trade-info"},tt={class:"trade-row"},et={class:"trade-item"},ot={key:0},at={class:"trade-label"},it={class:"trade-value"},nt={class:"trade-item"},lt={class:"trade-label"},dt={class:"trade-value"},ct=W({__name:"index",setup(S){const n=H(),_=P(),w=X(),D=J();y(0);const g=y([]),b=y([]),c=Z(()=>{const t=g.value.map(l=>l.turnover_numeric).reduce((l,f)=>m(l,f),0),o=b.value.map(l=>l.turnover_numeric).reduce((l,f)=>m(l,f),0);return{buyNumber:t,sellNumber:o,buyGreenBFB:+m(t,o)?N(L(t,m(t,o)),100):50,sellRedBFB:+m(t,o)?N(L(o,m(t,o)),100):50}}),r=()=>C(this,null,function*(){w.push({path:"/marketDetail",query:{stockId:n.stockDetail.id}})}),k=()=>{w.push({name:"dealings",query:{stockId:n.stockDetail.id}})},a=y({}),B=y(!0),T=()=>C(this,null,function*(){const t=Object.keys(n.stockDetail).length>0,o=D.query.stockId;o&&!t&&(yield n.getStockDetail({stockId:o})),a.value=n.stockDetail,B.value=!0;try{yield n.getStockWsDepth(n.stockDetail.stockCode),g.value=n.buyList,b.value=n.sellList}catch(l){B.value=!1}finally{B.value=!1}}),E=()=>{F.subscribe(_.wsKey,(t,o)=>{a.value.stockCode==o.pid&&Object.assign(a.value,{last:o.last_numeric,chgPct:o.pcp,chg:o.pc,high:o.high,low:o.low})})};return x(()=>C(this,null,function*(){yield T(),E()})),ss(()=>{F.unsubscribe(_.wsKey)}),(t,o)=>{const l=G,f=A,K=z,R=q,Y=ts("loading");return h(),v("div",ls,[$(f,null,{default:O(()=>{var u,p;return[s("div",ds,[s("div",cs,[s("div",rs,e((u=a.value)==null?void 0:u.symbol),1),s("div",us,[s("div",_s,e((p=a.value)==null?void 0:p.name),1)])]),s("div",vs,[$(l,{class:"like",round:!1,"model-value":a.value,"onUpdate:modelValue":o[0]||(o[0]=j=>Object.assign(a.value,j))},null,8,["model-value"])])])]}),_:1}),s("div",hs,[s("div",ps,[s("div",ms,e(("point_"in t?t.point_:i(d))(a.value.last)),1),s("div",gs,[s("span",{class:I([("getColorClass"in t?t.getColorClass:i(M))(a.value.chg),"with-bg"])},e(("point_"in t?t.point_:i(d))(a.value.chg)),3),s("span",{class:I([("getColorClass"in t?t.getColorClass:i(M))(a.value.chg),"with-bg"])},"("+e(("point_"in t?t.point_:i(d))(a.value.chgPct))+"%)",3)])]),s("div",bs,[s("div",ks,e(a.value.exchangeId=="46"?t.$t("NSE"):t.$t("BSE")),1)])]),s("div",fs,[s("div",ys,[s("div",ws,[s("div",Ds,e(t.$t("MarketDepth")),1),s("div",{class:"view-chart",onClick:r},[$(K,{name:"icon-Kxian",class:"icon"}),s("span",null,e(t.$t("ViewChart")),1)])]),es((h(),v("div",Bs,[s("div",Cs,[s("div",$s,[s("div",Ss,[s("p",null,e(t.$t("Bid")),1),s("div",Ns,e(t.$t("Order")),1),s("div",Ls,e(t.$t("Qty")),1)]),(h(!0),v(V,null,Q(g.value,(u,p)=>(h(),v("div",{class:"table-row",key:p},[s("p",null,e(("point_"in t?t.point_:i(d))(u.bid)),1),o[1]||(o[1]=s("div",{class:"text-center"},"1",-1)),s("div",Ms,e(u.turnover_numeric),1)]))),128))]),s("div",Fs,[s("div",Os,[s("p",null,e(t.$t("Offer")),1),s("div",Is,e(t.$t("Order")),1),s("div",Vs,e(t.$t("Qty")),1)]),(h(!0),v(V,null,Q(b.value,(u,p)=>(h(),v("div",{class:"table-row",key:p},[s("p",null,e(("point_"in t?t.point_:i(d))(u.ask)),1),o[2]||(o[2]=s("div",{class:"text-center"},"1",-1)),s("div",Qs,e(u.turnover_numeric),1)]))),128))])]),s("div",Ts,[s("div",Es,[s("div",null,e(i(c).buyGreenBFB)+" % ("+e(i(c).buyNumber)+") ",1),s("div",null," ("+e(i(c).sellNumber)+") "+e(i(c).sellRedBFB)+" % ",1)]),s("div",Ks,[s("div",{class:"ratio-progress",style:os({width:i(c).buyGreenBFB+"%"})},null,4)]),s("div",Rs,[s("div",null,e(t.$t("TotalBuyQuantity")),1),s("div",null,e(t.$t("TotalSellQuantity")),1)])])])),[[Y,B.value]])]),s("div",Ys,[s("div",js,[s("div",qs,[s("div",zs,e(t.$t("Last")),1),s("div",As,e(("point_"in t?t.point_:i(d))(a.value.last)),1)]),s("div",Gs,[s("div",Us,e(t.$t("High")),1),s("div",Hs,e(("point_"in t?t.point_:i(d))(a.value.high)),1)]),s("div",Ps,[s("div",Ws,e(t.$t("Low")),1),s("div",Xs,e(("point_"in t?t.point_:i(d))(a.value.low)),1)]),s("div",Js,[s("div",Zs,e(t.$t("Volume")),1),s("div",xs,e(("point_"in t?t.point_:i(d))(a.value.volume)),1)])])]),s("div",st,[s("div",tt,[s("div",et,[a.value.turnover_numeric?(h(),v("div",ot,[s("div",at,e(t.$t("LastTradedQty")),1),s("div",it,e(("point_"in t?t.point_:i(d))(a.value.turnover_numeric)),1)])):as("",!0)]),s("div",nt,[s("div",lt,e(t.$t("LastTradedOn")),1),s("div",dt,e(("formatDMYhms"in t?t.formatDMYhms:i(U))(a.value.time*1e3)),1)])])]),$(R,{block:"",onClick:k},{default:O(()=>[is(e(t.$t("BUY")),1)]),_:1})])])}}}),wt=ns(ct,[["__scopeId","data-v-69104823"]]);export{wt as default};
