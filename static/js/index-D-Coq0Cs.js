var y=(I,h,_)=>new Promise((g,c)=>{var f=a=>{try{l(_.next(a))}catch(o){c(o)}},i=a=>{try{l(_.throw(a))}catch(o){c(o)}},l=a=>a.done?g(a.value):Promise.resolve(a.value).then(f,i);l((_=_.apply(I,h)).next())});import{_ as q}from"./success-B3X_DW1C.js";import{_ as K}from"./index-BeltsHFN.js";import{_ as R}from"./PublicButton-CnD3tZlj.js";import{_ as W}from"./MainButton.vue_vue_type_script_setup_true_lang-B7_wmTtQ.js";import{_ as j}from"./index-Blhuho0a.js";import{a as z,A as Q,z as Y,S as F,r as v,N as H,R as X,a8 as G,a9 as V,p as J,o as Z,B as s,e as u,w as k,E as n,D as P,u as m,aa as x,X as C,M as ss}from"./vendor-DixqdoKt.js";import{_ as es}from"./customHeader-B56jzoOn.js";import{g as $}from"./index-BW6EuzMu.js";import{p as S,M as B}from"./big-Bs49lsdF.js";import{u as os,a as ts}from"./stock-X0YulnmI.js";import{c as ns,W as as,A as is,_ as ls}from"./index-BXVDO5jB.js";import{l as cs}from"./loading-8XKiFQcW.js";import"./index-CyUaUaxn.js";const ds={class:"dealings"},rs={class:"stock-symbol"},us={class:"stock-info-section"},_s={class:"stock-price-cards"},ps={class:"price-card nse-card"},vs={class:"price-info"},ms={class:"exchange-name"},hs={class:"price-change"},gs={class:"trading-section"},fs={class:"trading-row"},bs={class:"trading-header"},ys={class:"header-item"},ks={class:"header-item"},ws={class:"trading-controls"},Cs={class:"quantity-section"},Ss={class:"bottom-buy-section"},Is={class:"confirm_order"},Vs={class:"confirm_title"},Ps={class:"buy-text"},$s={class:"stock-info"},Bs={class:"tips"},Ds={class:"exchange-tag"},Ts={class:"symbol-name"},Ns={class:"content-row"},Us={class:"content-label"},As={class:"content-value"},Os={class:"content-row"},Es={class:"content-label"},Ls={class:"content-value"},Ms={class:"content-row"},qs={class:"content-label"},Ks={class:"content-value"},Rs={class:"content-row"},Ws={class:"content-label"},js={class:"content-value"},zs=z({__name:"index",setup(I){Q();const h=Y(),{t:_}=F(),g=ns(),c=os(),f=ts(),i=v("1"),l=v(!1),a=()=>{l.value=!0},o=v({}),D=()=>y(this,null,function*(){const t=Object.keys(c.stockDetail).length>0,e=h.query.stockId,p=h.query.stockCode;(e||p)&&!t&&(p&&(yield c.getStockDetail({stockCode:p})),e&&(yield c.getStockDetail({stockId:e})))}),d=v(""),T=()=>{V.subscribe(f.wsKey,(t,e)=>{o.value.stockCode==e.pid&&Object.assign(o.value,{last:e.last_numeric,chgPct:e.pcp,chg:e.pc,high:e.high,low:e.low})})};H(()=>y(this,null,function*(){yield D(),o.value=c.stockDetail,d.value=S(o.value.last),T()}));const b=X({exchangeId:"",buyLimitDateType:0,buyPriceLimitAmt:"",buyPriceLimitType:1,orderDirection:1,lever:1,memberId:"",orderNum:i.value,state:0,stockCode:o.value.stockCode,type:0,tradeAccountType:1,isVip:o.value.isVip&&o.value.isVip==="vip"?1:0}),w=v(!1),N=()=>y(this,null,function*(){const t=B(d.value,i.value);if(g.overallBalanceInfo.availableBalance<t){as(_("Insufficientbalance"));return}b.memberId=g.userInfo.id,b.buyPriceLimitAmt=d.value,b.exchangeId=o.value.exchangeId?o.value.exchangeId:void 0;const e=yield cs.show();try{(yield is(b)).code===200&&(l.value=!1,w.value=!0)}finally{e.close()}});return G(()=>{V.unsubscribe(f.wsKey)}),(t,e)=>{const p=es,U=x,A=j,O=W,E=R,L=K,M=q;return Z(),J(ss,null,[s("div",ds,[u(p,null,{default:k(()=>[s("div",rs,n(o.value.symbol),1)]),_:1}),s("div",us,[s("div",_s,[s("div",ps,[e[4]||(e[4]=s("div",{class:"exchange-icon"},[s("div",{class:"icon-circle orange"})],-1)),s("div",vs,[s("div",ms,n(o.value.exchangeId=="46"?"NSE":"BSE")+" : "+n(o.value.name||o.value.symbol),1),s("div",hs,[s("p",{class:P(["price",["with-bg",("getColorClass"in t?t.getColorClass:m($))(o.value.chg)]])},n(("point_"in t?t.point_:m(S))(o.value.chg)),3),s("p",{class:P(["change",["with-bg",("getColorClass"in t?t.getColorClass:m($))(o.value.chgPct)]])}," ("+n(("point_"in t?t.point_:m(S))(o.value.chgPct))+"%) ",3)])])])])]),s("div",gs,[s("div",fs,[s("div",bs,[s("div",ys,n(t.$t("Quantity")),1),s("div",ks,n(t.$t("Price")),1)]),s("div",ws,[s("div",Cs,[u(U,{integer:"",class:"stepper",modelValue:i.value,"onUpdate:modelValue":e[0]||(e[0]=r=>i.value=r),theme:"round"},null,8,["modelValue"])]),u(A,{modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=r=>d.value=r),type:"number",class:"price-input",disabled:""},null,8,["modelValue"])])])]),s("div",Ss,[u(O,{class:"buy-button",onClick:a},{default:k(()=>[C(n(t.$t("TAP TO BUY")),1)]),_:1})])]),u(L,{show:l.value,"onUpdate:show":e[2]||(e[2]=r=>l.value=r)},{default:k(()=>[s("div",Is,[s("div",Vs,[C(n(t.$t("Confirm Order"))+" : ",1),s("span",Ps,n(t.$t("BUY")),1)]),s("div",$s,[s("p",null,n(o.value.name),1),s("div",Bs,[s("span",Ds,n(o.value.exchangeId=="46"?"NSE":"BSE"),1),s("div",Ts,n(o.value.symbol),1)])]),s("div",Ns,[s("div",Us,n(t.$t("Quantity")),1),e[5]||(e[5]=s("div",{class:"colon"},":",-1)),s("div",As,n(i.value),1)]),s("div",Os,[s("div",Es,n(t.$t("Price")),1),e[6]||(e[6]=s("div",{class:"colon"},":",-1)),s("div",Ls,n(d.value),1)]),s("div",Ms,[s("div",qs,n(t.$t("Total price")),1),e[7]||(e[7]=s("div",{class:"colon"},":",-1)),s("div",Ks,n(m(B)(d.value,i.value)),1)]),s("div",Rs,[s("div",Ws,n(t.$t("Order Type")),1),e[8]||(e[8]=s("div",{class:"colon"},":",-1)),s("div",js,n(t.$t("NormalStock")),1)]),u(E,{class:"confirm",onClick:N},{default:k(()=>[C(n(t.$t("Confirm")),1)]),_:1})])]),_:1},8,["show"]),u(M,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=r=>w.value=r)},null,8,["modelValue"])],64)}}}),ae=ls(zs,[["__scopeId","data-v-dc83110f"]]);export{ae as default};
