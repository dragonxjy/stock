var v=(B,p,m)=>new Promise((r,a)=>{var f=i=>{try{b(m.next(i))}catch(y){a(y)}},P=i=>{try{b(m.throw(i))}catch(y){a(y)}},b=i=>i.done?r(i.value):Promise.resolve(i.value).then(f,P);b((m=m.apply(B,p)).next())});import{_ as W}from"./index-BeltsHFN.js";import{_ as j}from"./MainButton.vue_vue_type_script_setup_true_lang-B7_wmTtQ.js";import{_ as H}from"./index-Blhuho0a.js";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang-Cd_OulVb.js";import{_ as q}from"./index-BmwkXZpg.js";import{_ as G}from"./index-CyUaUaxn.js";import{c as J,h as K,W as L,i as Q,S as Y,j as Z,_ as ee}from"./index-BXVDO5jB.js";import{a as se,S as te,A as oe,R as S,r as u,N as ae,p as T,o as V,e as _,w as $,M as z,O as ne,u as s,B as e,E as o,F as le,I as R,X as ie}from"./vendor-DixqdoKt.js";import{p as g}from"./big-Bs49lsdF.js";import"./index-BW6EuzMu.js";import"./PublicButton-CnD3tZlj.js";import"./index-Bhr3i5rn.js";const de=["onClick"],re={class:"trade-header"},ce={class:"trade-title"},ue={class:"trade-time"},_e={class:"trade-details"},pe={class:"trade-info"},me={class:"label"},fe={class:"value"},he={class:"trade-info"},ve={class:"label"},ge={class:"value"},be={class:"trade-info"},ye={class:"label"},ke={class:"time price"},we={class:"popup_content"},Pe={class:"flex-between font_bold"},Ne={class:"font_black"},Te={class:"font_red"},Ve={class:"from_item"},$e={key:0,class:"from_item"},Ae={class:"flex-between mart_30"},Ie={class:"font_gray"},Le={class:"font_red"},Re={class:"flex-between mart_30"},Be={class:"font_gray"},Ce={class:"font_red"},Se={class:"flex-between mart_30"},ze={class:"font_gray"},De={class:"font_red"},Me={class:"blockTrade_info_message"},Ue={class:"font_notice"},Ee=se({__name:"index",setup(B){const{t:p}=te(),m=oe(),r=J(),a=S({tradeList:[],loading:!1,finished:!1,total:0}),f=u({pageNum:1,pageSize:10}),P=()=>v(this,null,function*(){const t=yield Z(f.value);t.code===200&&(a.loading=!1,t.body.records.length!=f.value.pageSize?a.finished=!0:f.value.pageNum++,a.tradeList=[...a.tradeList,...t.body.records],a.total=t.body.total)}),b=()=>v(this,null,function*(){a.finished=!1,P()}),i=u(0),y=()=>v(this,null,function*(){const t=yield K(r.userInfo.id);t.code===200&&(i.value=t.body)}),c=u(),h=u(""),A=u(0);ae(()=>v(this,null,function*(){yield y(),A.value=r.balanceInfo.enableAmt||0}));const l=u({}),k=u(!1),D=t=>{l.value=t,k.value=!0},w=S({memberId:r.userInfo.id,stockCode:"",tradePwd:"",applyNum:"",id:""}),N=u(!1),M=()=>v(this,null,function*(){if(!c.value){L(p("Pleaseinput"));return}if((l.value&&l.value.spreadRate?Number(l.value.spreadRate):0)*Number(c.value||0)+Number(i.value||0)>Number(A.value||0)){L(p("notMoreThanMax"));return}if(r.settingInfo.isDzTradePwd==1&&!h.value){L(p("DazongPassword"));return}w.stockCode=l.value.stockCode,w.applyNum=c.value,w.id=l.value.id,r.settingInfo.isDzTradePwd==1&&(w.tradePwd=h.value),N.value=!0;try{(yield Q(w)).code===200&&(Y(p("Buyingsucceeded")),k.value=!1,c.value="",h.value="",f.value.pageNum=1,a.tradeList=[],P())}catch(I){N.value=!1}finally{N.value=!1}}),U=()=>{m.push({name:"blockTradeRecords"})};return(t,d)=>{const I=G,E=q,O=X,C=H,x=j,F=W;return V(),T(z,null,[_(E,null,{right:$(()=>[_(I,{name:"icon-shizhong",class:"icon",onClick:U})]),_:1}),_(O,{modelValue:s(a).loading,"onUpdate:modelValue":d[0]||(d[0]=n=>s(a).loading=n),finished:s(a).finished,list:s(a).tradeList,onLoad:b,class:"tradeList"},{default:$(()=>[(V(!0),T(z,null,ne(s(a).tradeList,n=>(V(),T("div",{onClick:Oe=>D(n),key:n.id,class:"trade-item"},[e("div",re,[e("h3",ce,o(n.stockName),1),e("span",ue,o(n.exchangeId==46?"NSE":"BSE"),1)]),e("div",_e,[e("div",pe,[e("span",me,o(t.$t("Original price"))+":",1),e("span",fe,o(s(g)(n.last)),1)]),e("div",he,[e("span",ve,o(t.$t("Min Order"))+":",1),e("span",ge,o(n.stockNum),1)])]),e("div",be,[e("span",ye,o(t.$t("Last Price"))+":",1),e("span",ke,o(s(g)(n.spreadRate)),1)])],8,de))),128))]),_:1},8,["modelValue","finished","list"]),_(F,{modelValue:s(k),"onUpdate:modelValue":d[3]||(d[3]=n=>R(k)?k.value=n:null),title:t.$t("BlockTrade")},{default:$(()=>[e("div",we,[e("div",Pe,[e("p",Ne,o(t.$t("Subscription price")),1),e("p",Te,o(s(l)&&s(l).spreadRate?s(g)(s(l).spreadRate):"0.00"),1)]),e("div",Ve,[_(C,{label:"",modelValue:s(c),"onUpdate:modelValue":d[1]||(d[1]=n=>R(c)?c.value=n:null),type:"digit",maxlength:"8",placeholder:t.$t("Pleaseenterthenumberofsharestobepurchased")},null,8,["modelValue","placeholder"])]),s(r).settingInfo.isDzTradePwd==1?(V(),T("div",$e,[_(C,{placeholder:t.$t("DazongPassword"),modelValue:s(h),"onUpdate:modelValue":d[2]||(d[2]=n=>R(h)?h.value=n:null),type:"password"},null,8,["placeholder","modelValue"])])):le("",!0),e("div",Ae,[e("p",Ie,o(t.$t("Purchaseamount")),1),e("p",Le,o(s(l)&&s(l).spreadRate?s(g)(s(l).spreadRate*s(c)):"0.00"),1)]),e("div",Re,[e("p",Be,o(t.$t("DzPenddingAmt")),1),e("p",Ce,o(s(g)(s(i))),1)]),e("div",Se,[e("p",ze,o(t.$t("Availablefunds")),1),e("p",De,o(s(g)(s(A))),1)]),e("div",Me,[d[4]||(d[4]=e("br",null,null,-1)),e("p",Ue,o(t.$t("BlockTradeNotice")),1)]),_(x,{loading:s(N),class:"btn_submit",onClick:M},{default:$(()=>[ie(o(t.$t("Buy")),1)]),_:1},8,["loading"])])]),_:1},8,["modelValue","title"])],64)}}}),es=ee(Ee,[["__scopeId","data-v-fb212190"]]);export{es as default};
