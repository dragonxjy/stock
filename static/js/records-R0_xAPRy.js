var c=(D,f,d)=>new Promise((y,u)=>{var b=l=>{try{r(d.next(l))}catch(i){u(i)}},g=l=>{try{r(d.throw(l))}catch(i){u(i)}},r=l=>l.done?y(l.value):Promise.resolve(l.value).then(b,g);r((d=d.apply(D,f)).next())});import{a as j,S as q,r as n,N as G,p,o as _,B as e,e as v,E as a,u as m,w as h,V as H,M as B,O as I,D as T,W as J}from"./vendor-DixqdoKt.js";import{_ as K}from"./index.vue_vue_type_script_setup_true_lang-Cd_OulVb.js";import{p as R}from"./big-Bs49lsdF.js";import{f as M}from"./index-BW6EuzMu.js";import{c as Q,v as X,x as Z,y as x,_ as ss}from"./index-BXVDO5jB.js";const es={class:"loan-records"},as={class:"stats-panel"},ts={class:"stats-item"},os={class:"stats-value"},ns={class:"stats-label"},ls={class:"stats-item"},ds={class:"stats-value"},rs={class:"stats-label"},is={class:"stats-item"},cs={class:"stats-value"},us={class:"stats-label"},ps={class:"records-container"},_s={class:"records-list"},vs={class:"record-header"},ms={class:"record-type"},hs={class:"type-text"},fs={class:"record-details"},ys={class:"detail-row"},bs={class:"detail-label"},gs={class:"detail-value"},ws={class:"detail-row"},Ls={class:"detail-label"},As={class:"detail-value"},$s={class:"detail-row"},Rs={class:"detail-label"},Ds={class:"detail-value"},Ss={class:"records-container"},Vs={class:"records-list"},ks={class:"record-header"},Bs={class:"record-type"},Is={class:"type-text"},Ts={class:"record-details"},Ms={class:"detail-row"},Ns={class:"detail-label"},zs={class:"detail-value"},Cs={class:"detail-row"},Ys={class:"detail-label"},Fs={class:"detail-value"},Us={class:"detail-row"},Ws={class:"detail-label"},Es={class:"detail-value"},Os={class:"detail-row"},Ps={class:"detail-label"},js={class:"detail-value"},qs={class:"detail-row"},Gs={class:"detail-label"},Hs={class:"detail-value"},Js=j({__name:"records",setup(D){const f=Q(),{t:d}=q(),y=n(0),u=n(""),b=n(""),g=n(""),r=n([]),l=n(!1),i=n(!1),w=n([]),$=n(!1),S=n(!1),N=s=>{switch(s){case 0:return"status-pending";case 1:return"status-approved";case 2:return"status-rejected";default:return"status-default"}},z=s=>{switch(s){case 0:return d("Waiting")+"...";case 1:return d("Approved");case 2:return d("Refuse");default:return""}},C=s=>{switch(s){case 2:return"repayment-offline";case 3:return"repayment-backend";default:return"repayment-default"}},Y=s=>{switch(s){case 2:return d("Offlinetransfer");case 3:return d("Backendtransfer");default:return""}},F=()=>c(this,null,function*(){try{const s=yield X();if(s.code===200){const o=s.body;u.value=o.totalLoanAmount,b.value=o.repairedAmount,g.value=o.availableBalance}}catch(s){console.error("èŽ·å–è´·æ¬¾æ€»ä¿¡æ¯å¤±è´¥:",s)}}),L=n({pageNum:1,pageSize:10,memberId:f.userInfo.id,orderField:"create_date",order:"desc"}),U=()=>c(this,null,function*(){try{const s=yield Z(L.value);s.code===200&&(r.value=[...r.value,...s.body.records||[]],L.value.total=s.body.total,s.body.records.length<L.value.pageSize?i.value=!0:L.value.pageNum++)}catch(s){console.error("èŽ·å–è´·æ¬¾è®°å½•å¤±è´¥:",s)}finally{l.value=!1}}),W=()=>c(this,null,function*(){yield U()}),A=n({pageNum:1,pageSize:10,memberId:f.userInfo.id,orderField:"repayment_date",order:"desc"}),E=()=>c(this,null,function*(){try{const s=yield x(A.value);s.code===200&&(w.value=[...w.value,...s.body.records||[]],A.value.total=s.body.total,s.body.records.length<A.value.pageSize?S.value=!0:A.value.pageNum++)}catch(s){console.error("èŽ·å–è¿˜æ¬¾è®°å½•å¤±è´¥:",s)}finally{$.value=!1}}),O=()=>c(this,null,function*(){yield E()});return G(()=>{F()}),(s,o)=>{const V=K,k=H,P=J;return _(),p("div",es,[e("div",as,[e("div",ts,[e("div",os,a(("point_"in s?s.point_:m(R))(u.value)),1),e("div",ns,a(s.$t("totalLoanAmount")),1)]),e("div",ls,[e("div",ds,a(("point_"in s?s.point_:m(R))(b.value)),1),e("div",rs,a(s.$t("Repaidamount")),1)]),e("div",is,[e("div",cs,a(("point_"in s?s.point_:m(R))(g.value)),1),e("div",us,a(s.$t("availableBalance")),1)])]),v(P,{class:"records-tabs",active:y.value,"onUpdate:active":o[2]||(o[2]=t=>y.value=t)},{default:h(()=>[v(k,{title:s.$t("Loan")},{default:h(()=>[e("div",ps,[v(V,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=t=>l.value=t),finished:i.value,list:r.value,onLoad:W},{default:h(()=>[e("div",_s,[(_(!0),p(B,null,I(r.value,t=>(_(),p("div",{class:"record-card",key:t.id},[e("div",vs,[e("div",ms,[o[3]||(o[3]=e("span",{class:"type-icon"},"ðŸ“‹",-1)),e("span",hs,a(s.$t("Loan")),1)]),e("div",{class:T(["status-badge",N(t.status)])},a(z(t.status)),3)]),e("div",fs,[e("div",ys,[e("span",bs,a(s.$t("Loanamount")),1),e("span",gs,a(t.actualLoanAmount?t.actualLoanAmount:t.loanApplyAmount),1)]),e("div",ws,[e("span",Ls,a(s.$t("Workordernumber")),1),e("span",As,a(t.id),1)]),e("div",$s,[e("span",Rs,a(s.$t("Applicationdate")),1),e("span",Ds,a(("formatDMYhms"in s?s.formatDMYhms:m(M))(t.createTime)),1)])])]))),128))])]),_:1},8,["modelValue","finished","list"])])]),_:1},8,["title"]),v(k,{title:s.$t("Repayment")},{default:h(()=>[e("div",Ss,[v(V,{modelValue:$.value,"onUpdate:modelValue":o[1]||(o[1]=t=>$.value=t),list:w.value,finished:S.value,onLoad:O},{default:h(()=>[e("div",Vs,[(_(!0),p(B,null,I(w.value,t=>(_(),p("div",{class:"record-card",key:t.id},[e("div",ks,[e("div",Bs,[o[4]||(o[4]=e("span",{class:"type-icon"},"ðŸ’³",-1)),e("span",Is,a(s.$t("Repayment")),1)]),e("div",{class:T(["repayment-type",C(t.id)])},a(Y(t.id)),3)]),e("div",Ts,[e("div",Ms,[e("span",Ns,a(s.$t("Workordernumber")),1),e("span",zs,a(t.id),1)]),e("div",Cs,[e("span",Ys,a(s.$t("Loanamount")),1),e("span",Fs,a(t.loanAmt),1)]),e("div",Us,[e("span",Ws,a(s.$t("Repaymentamount")),1),e("span",Es,a(t.repaymentAmt),1)]),e("div",Os,[e("span",Ps,a(s.$t("repairedAmount")),1),e("span",js,a(t.repaidAmt||0),1)]),e("div",qs,[e("span",Gs,a(s.$t("Repaymentdate")),1),e("span",Hs,a(("formatDMYhms"in s?s.formatDMYhms:m(M))(t.repaymentDate)),1)])])]))),128))])]),_:1},8,["modelValue","list","finished"])])]),_:1},8,["title"])]),_:1},8,["active"])])}}}),ee=ss(Js,[["__scopeId","data-v-4a6a7fc0"]]);export{ee as default};
