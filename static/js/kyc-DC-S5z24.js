var N=($,k,i)=>new Promise((t,l)=>{var r=n=>{try{a(i.next(n))}catch(m){l(m)}},y=n=>{try{a(i.throw(n))}catch(m){l(m)}},a=n=>n.done?t(n.value):Promise.resolve(n.value).then(r,y);a((i=i.apply($,k)).next())});import{_ as R}from"./index-BMe1pI0l.js";import{a as E,r as d,$ as j,p as f,o as c,B as o,F as P,e as p,M as z,O as D,a0 as K,v as U,S as X,A as Y,N as G,w as C,E as h,c as I,X as T,Y as H}from"./vendor-DixqdoKt.js";import{_ as L}from"./index-CyUaUaxn.js";import{_ as J}from"./MainButton.vue_vue_type_script_setup_true_lang-B7_wmTtQ.js";import{_ as q}from"./index-Bhr3i5rn.js";import{q as Q,_ as x,c as Z,W as F,s as ee,S as ae}from"./index-BXVDO5jB.js";import{c as se}from"./index-BW6EuzMu.js";import{_ as oe}from"./index-Blhuho0a.js";const te={class:"uploads"},le={key:1,class:"upload-list"},ne={class:"upload-item"},ue=["onClick"],ce={key:2,class:"mask"},ie=E({__name:"index",props:{modelValue:{},multiple:{type:Boolean,default:!1},errorImage:{default:"no"}},emits:["update:modelValue","success","before-upload"],setup($,{emit:k}){const i=$,t=k,l=d([]);j(()=>{i.modelValue instanceof Array?l.value=i.modelValue:i.modelValue?l.value=i.modelValue.split(","):l.value=[]});const r=d(),y=()=>{U(()=>{var s;(s=r.value)==null||s.click()})},a=d(0),n=s=>N(this,null,function*(){const _=s.target,g=_.files,V=g[0];yield new Promise(v=>{t("before-upload",{resolve:v,files:g})});try{a.value=1;const v=yield se(V),e=yield Q(v);l.value=[`${e.body}`];const u=l.value[0];t("update:modelValue",u),t("success",{files:g,url:u}),_.value="",a.value=2}catch(v){a.value=2,U(()=>{l.value[0]=i.errorImage})}}),m=s=>{l.value.splice(s,1),a.value=0,t("update:modelValue","")};return(s,_)=>{const g=L,V=q,v=K;return c(),f("div",te,[o("input",{type:"file",class:"file",ref_key:"file",ref:r,onChange:n,accept:"image/*"},null,544),!l.value[0]&&a.value===0||s.multiple?(c(),f("div",{key:0,class:"upLoad",onClick:y},[p(g,{name:"icon-shangchuan",class:"icon"})])):P("",!0),a.value===1||a.value===2?(c(),f("div",le,[(c(!0),f(z,null,D(l.value,(e,u)=>(c(),f("div",ne,[p(V,{src:e,id:"image",loading:"lazy",class:"preview-image"},null,8,["src"]),o("div",{class:"delete-btn",onClick:w=>m(u)},[p(g,{name:"icon-guanbi",class:"delete-icon"})],8,ue)]))),256))])):P("",!0),a.value===1?(c(),f("div",ce,[p(v,{type:"spinner"})])):P("",!0)])}}}),re=x(ie,[["__scopeId","data-v-0b28bb93"]]),de={class:"kyc_content"},me={class:"kyc_item"},pe={class:"kyc_item"},_e={class:"content_uploader"},ve={class:"box"},fe={key:0,class:"uploader_box"},ye={class:"tips"},ge={class:"box"},ke={key:0,class:"uploader_box"},be={class:"tips"},he={class:"submit_section"},Ve={class:"successContent"},Ie={class:"btn_icon"},$e=E({__name:"kyc",setup($){const{t:k}=X(),i=Z(),t=d({}),l=Y(),r=d({memberId:"",realName:"",idCard:"",panCard:"",reversePanCard:""}),y=d(""),a=d(""),n=d(""),m=d(""),s=d(!1),_=d(!1),g=()=>N(this,null,function*(){if(r.value.realName=y.value,r.value.idCard=a.value,r.value.panCard=n.value,r.value.reversePanCard=m.value,!r.value.panCard){F(k("Pleaseuploadthefrontsideofyouridentitycard"));return}if(!r.value.reversePanCard){F(k("Pleaseuploadthebacksideofyouridentitycard"));return}_.value=!0,r.value.memberId=i.userInfo.memberId;try{const e=yield ee(r.value);_.value=!1,e.code==200&&(ae(k("Successful")),l.back())}catch(e){_.value=!1}finally{_.value=!1}}),V=()=>{Object.assign(t.value,i.userInfo),U(()=>{t.value.isActive==1||t.value.isActive==2?(s.value=!1,y.value=t.value.realName,a.value=t.value.idCard):s.value=!0})},v=({resolve:e,file:u})=>{e()};return G(()=>{V()}),(e,u)=>{const w=oe,A=re,B=q,S=J,M=L,W=H,O=R;return c(),f("div",de,[p(W,{onSubmit:g,class:"form"},{default:C(()=>[o("div",me,[o("p",null,h(e.$t("Name")),1),p(w,{modelValue:y.value,"onUpdate:modelValue":u[0]||(u[0]=b=>y.value=b),type:"text",class:"custom-field",autocomplete:"off",disabled:!s.value,rules:[{required:!0,message:e.$t("Pleaseenteryourname")}]},null,8,["modelValue","disabled","rules"])]),o("div",pe,[o("p",null,h(e.$t("Identity")),1),p(w,{modelValue:a.value,"onUpdate:modelValue":u[1]||(u[1]=b=>a.value=b),type:"text",class:"custom-field",autocomplete:"off",disabled:!s.value,rules:[{required:!0,message:e.$t("Pleaseentertheidentity")}]},null,8,["modelValue","disabled","rules"])]),o("div",_e,[o("div",ve,[s.value?(c(),f("div",fe,[p(A,{modelValue:n.value,"onUpdate:modelValue":u[2]||(u[2]=b=>n.value=b),onBeforeUpload:v,class:"uploads"},null,8,["modelValue"]),o("p",ye,h(e.$t("Pleaseuploadthefrontsideofyouridentitycard")),1)])):(c(),I(B,{key:1,fit:"contain",class:"cardImg",src:n.value},null,8,["src"]))]),o("div",ge,[s.value?(c(),f("div",ke,[p(A,{modelValue:m.value,"onUpdate:modelValue":u[3]||(u[3]=b=>m.value=b),onBeforeUpload:v,class:"uploads"},null,8,["modelValue"]),o("p",be,h(e.$t("Pleaseuploadthebacksideofyouridentitycard")),1)])):(c(),I(B,{key:1,fit:"contain",class:"cardImg",src:m.value},null,8,["src"]))])]),o("div",he,[s.value?(c(),I(S,{key:0,loading:_.value,block:""},{default:C(()=>[T(h(e.$t("Submit")),1)]),_:1},8,["loading"])):(c(),I(S,{key:1,block:"",disabled:""},{default:C(()=>[o("div",Ve,[o("div",Ie,[t.value.isActive!=1?(c(),I(M,{key:0,name:"icon-shenhetongguo"})):P("",!0)]),o("span",null,h(t.value.isActive==1?e.$t("Waitingforreview"):e.$t("Certified")),1)])]),_:1}))])]),_:1}),p(O,null,{default:C(()=>[T(h(e.$t("RealnameauthenticationTips")),1)]),_:1})])}}}),Fe=x($e,[["__scopeId","data-v-91506a9b"]]);export{Fe as default};
